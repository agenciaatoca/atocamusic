<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atoca Gem - Intelig√™ncia para Eventos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&family=Inter:wght@300;400;500;600;700&display=swap');
        
        :root {
            --gem-bg: #131314;
            --gem-surface: #1e1f20;
            --gem-border: #444746;
            --gem-blue: #8ab4f8;
        }

        body { 
            font-family: 'Inter', sans-serif; 
            background-color: var(--gem-bg); 
            color: #e3e3e3;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1, h2, h3 { font-family: 'Google Sans', sans-serif; }

        .input-area {
            background: #1e1f20;
            border: 1px solid var(--gem-border);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .input-area:focus-within {
            border-color: var(--gem-blue);
            background: #28292a;
        }

        .preset-chip {
            background: transparent;
            border: 1px solid var(--gem-border);
            color: #c4c7c5;
            transition: all 0.2s;
            cursor: pointer;
        }

        .preset-chip:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: #8e918f;
        }

        .gem-gradient {
            background: linear-gradient(135deg, #4285f4, #9b72cb, #d96570);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .loading-shimmer {
            background: linear-gradient(90deg, #1e1f20 25%, #2b2c2e 50%, #1e1f20 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }

        .response-card {
            background: #1e1f20;
            border: 1px solid var(--gem-border);
            border-radius: 24px;
        }

        .btn-fab {
            background: var(--gem-blue);
            color: #041e49;
            box-shadow: 0 4px 12px rgba(138, 180, 248, 0.3);
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="w-full max-w-4xl flex-1 flex flex-col">
        
        <!-- Header -->
        <header class="flex items-center justify-between mb-12 w-full px-4">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg bg-gradient-to-tr from-blue-500 to-purple-500 flex items-center justify-center">
                    <i class="fas fa-sparkles text-white text-[10px]"></i>
                </div>
                <h1 class="text-xl font-medium tracking-tight">Atoca <span class="text-slate-500">Gem</span></h1>
            </div>
            <span class="text-[10px] font-bold text-slate-500 uppercase tracking-widest bg-slate-800/50 px-3 py-1 rounded-full border border-slate-700">
                Engine 2.0 Flash
            </span>
        </header>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col w-full">
            
            <div id="welcome-screen" class="my-auto text-center space-y-6">
                <h2 class="text-4xl md:text-5xl font-medium tracking-tight leading-tight">Crie convites que <br><span class="gem-gradient font-bold italic">enchem seu bar.</span></h2>
                <p class="text-slate-400 text-sm max-w-md mx-auto">IA de copywriting treinada para transformar eventos musicais em faturamento para casas noturnas de Bras√≠lia.</p>
                
                <div class="flex flex-wrap justify-center gap-2 pt-6">
                    <div onclick="applyPreset('Pop Rock', 'Dose dupla de Gin at√© 22h')" class="preset-chip px-4 py-2 rounded-full text-xs font-medium">üé∏ Noite do Rock</div>
                    <div onclick="applyPreset('Sertanejo', 'Lista VIP dispon√≠vel no link da bio')" class="preset-chip px-4 py-2 rounded-full text-xs font-medium">ü§† Sexta Sertaneja</div>
                    <div onclick="applyPreset('Happy Hour', 'Combo de Chopp com 20% OFF')" class="preset-chip px-4 py-2 rounded-full text-xs font-medium">üçª Happy Hour</div>
                </div>
            </div>

            <!-- Loader -->
            <div id="ai-loading" class="hidden w-full max-w-2xl mx-auto space-y-4 my-auto">
                <div class="h-4 w-3/4 loading-shimmer rounded-full opacity-50"></div>
                <div class="h-4 w-full loading-shimmer rounded-full opacity-50"></div>
                <div class="h-4 w-1/2 loading-shimmer rounded-full opacity-50"></div>
                <p class="text-center text-xs text-slate-600 animate-pulse mt-4">REDA√á√ÉO ESTRAT√âGICA EM ANDAMENTO...</p>
            </div>

            <!-- Response -->
            <div id="response-container" class="hidden w-full max-w-3xl mx-auto space-y-6 my-auto">
                <div class="response-card p-8 shadow-2xl relative border-l-4 border-l-blue-500">
                    <div id="output-text" class="text-slate-200 text-lg leading-relaxed whitespace-pre-wrap font-medium"></div>
                </div>
                <div class="flex flex-col md:flex-row items-center justify-center gap-4">
                    <button onclick="copyContent()" class="btn-fab w-full md:w-auto px-10 py-4 rounded-full font-bold text-sm transition-all flex items-center justify-center gap-2">
                        <i class="fas fa-copy"></i> COPIAR PARA WHATSAPP
                    </button>
                    <button onclick="resetApp()" class="text-slate-500 hover:text-white text-xs font-bold uppercase tracking-widest px-4 py-3">
                        <i class="fas fa-plus mr-2"></i> Criar outro
                    </button>
                </div>
            </div>
        </main>

        <!-- Command Bar -->
        <div class="mt-8 mb-4 w-full">
            <div class="max-w-3xl mx-auto input-area p-2 rounded-[2.5rem] flex flex-col gap-2 shadow-2xl">
                <div class="flex flex-col md:flex-row gap-2 px-4 pt-2">
                    <input type="text" id="bar-name" placeholder="Nome do Bar..." 
                           class="flex-1 bg-transparent py-2 text-white text-sm outline-none border-none placeholder-slate-700 font-medium">
                    <div class="hidden md:block w-[1px] h-6 bg-slate-700 self-center"></div>
                    <input type="text" id="style-text" placeholder="Estilo ou Atra√ß√£o..." 
                           class="flex-1 bg-transparent py-2 text-white text-sm outline-none border-none placeholder-slate-700 font-medium">
                </div>
                <div class="relative flex items-center pb-2">
                    <textarea id="extra-info" rows="1" placeholder="Promo√ß√£o ou detalhe extra..." 
                              class="flex-1 bg-transparent px-4 py-3 text-slate-300 text-sm outline-none border-none placeholder-slate-700 resize-none overflow-hidden"></textarea>
                    <button onclick="generateInvite()" id="btn-generate" 
                            class="mr-2 w-12 h-12 rounded-full flex items-center justify-center transition-all bg-sky-500 text-slate-900 hover:bg-sky-400 active:scale-90">
                        <i id="send-icon" class="fas fa-arrow-up"></i>
                        <div id="spinner" class="hidden w-5 h-5 border-2 border-slate-900 border-t-transparent rounded-full animate-spin"></div>
                    </button>
                </div>
            </div>
            <p class="text-center text-[9px] text-slate-700 mt-4 uppercase tracking-[0.3em]">IA Propriet√°ria Atoca Music &copy; 2026</p>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="fixed bottom-10 left-1/2 -translate-x-1/2 bg-white text-slate-950 px-6 py-3 rounded-full text-xs font-bold shadow-2xl hidden z-[100]">
        <span id="toast-text"></span>
    </div>

    <script>
        // CHAVE DE API ATUALIZADA (CONFORME SOLICITADO NO CURL)
        const apiKey = "AIzaSyCIHzpf-iw_SocQOJq_dbGs7fJwt-6hogk"; 

        function applyPreset(style, extra) {
            document.getElementById('style-text').value = style;
            document.getElementById('extra-info').value = extra;
            showToast(`Configurado para ${style}!`);
            const tx = document.getElementById('extra-info');
            tx.style.height = "auto";
            tx.style.height = (tx.scrollHeight) + "px";
        }

        function showToast(msg) {
            const el = document.getElementById('toast');
            document.getElementById('toast-text').innerText = msg;
            el.classList.remove('hidden');
            setTimeout(() => el.classList.add('hidden'), 3000);
        }

        function resetApp() {
            document.getElementById('welcome-screen').classList.remove('hidden');
            document.getElementById('response-container').classList.add('hidden');
            document.getElementById('bar-name').value = "";
            document.getElementById('style-text').value = "";
            document.getElementById('extra-info').value = "";
            document.getElementById('extra-info').style.height = "auto";
        }

        async function callGemini(prompt, sysPrompt) {
            // Endpoint para Gemini 2.0 Flash est√°vel
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ 
                    parts: [{ text: `INSTRU√á√ÉO DE SISTEMA: ${sysPrompt}\n\nREQUISI√á√ÉO: ${prompt}` }] 
                }]
            };

            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error?.message || "Falha na conex√£o");
            }
            
            const data = await response.json();
            return data.candidates[0].content.parts[0].text;
        }

        async function generateInvite() {
            const bar = document.getElementById('bar-name').value;
            const style = document.getElementById('style-text').value;
            const extra = document.getElementById('extra-info').value;
            
            const welcome = document.getElementById('welcome-screen');
            const loading = document.getElementById('ai-loading');
            const container = document.getElementById('response-container');
            const output = document.getElementById('output-text');
            const sendIcon = document.getElementById('send-icon');
            const spinner = document.getElementById('spinner');

            if (!bar) return showToast("Por favor, informe o nome do bar.");

            // UI Loading State
            welcome.classList.add('hidden');
            container.classList.add('hidden');
            loading.classList.remove('hidden');
            sendIcon.classList.add('hidden');
            spinner.classList.remove('hidden');

            const sys = `Voc√™ √© o Atoca Gem, copywriter de elite da Atoca Music. 
            Crie um convite para WhatsApp e Instagram que lote o bar de Bras√≠lia mencionado.
            DIRETRIZES: use muitos emojis, tom vibrante e persuasivo. Fale como se conhecesse a vibe da noite de Bras√≠lia (Asa Sul, Norte, √Åguas Claras).
            ESTRUTURA: Gancho impactante -> Clima da noite -> Oferta/Atra√ß√£o -> Chamada para a√ß√£o clara.`;

            const prompt = `Bar: "${bar}". Atra√ß√£o/Estilo: "${style}". Oferta Extra: "${extra}".`;

            try {
                const text = await callGemini(prompt, sys);
                output.innerText = text;
                loading.classList.add('hidden');
                container.classList.remove('hidden');
                showToast("Convite gerado! ‚ú®");
            } catch (error) {
                console.error(error);
                showToast("Erro: " + error.message);
                welcome.classList.remove('hidden');
                loading.classList.add('hidden');
            } finally {
                sendIcon.classList.remove('hidden');
                spinner.classList.add('hidden');
            }
        }

        function copyContent() {
            const text = document.getElementById('output-text').innerText;
            const textArea = document.createElement("textarea");
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            showToast("Texto copiado! ‚ú®");
        }

        // Auto-expand textarea
        const tx = document.getElementById('extra-info');
        tx.addEventListener("input", function() {
            this.style.height = "auto";
            this.style.height = (this.scrollHeight) + "px";
        }, false);
    </script>
</body>
</html>
